<svg id="mermaid-1570898143990" width="100%" xmlns="http://www.w3.org/2000/svg" height="100%" style="max-width:5250px;" viewBox="-50 -10 5250 6585"><style>#mermaid-1570898143990 .label{font-family:'trebuchet ms', verdana, arial;color:#333}#mermaid-1570898143990 .label text{fill:#333}#mermaid-1570898143990 .node rect,#mermaid-1570898143990 .node circle,#mermaid-1570898143990 .node ellipse,#mermaid-1570898143990 .node polygon{fill:#ECECFF;stroke:#9370db;stroke-width:1px}#mermaid-1570898143990 .node.clickable{cursor:pointer}#mermaid-1570898143990 .arrowheadPath{fill:#333}#mermaid-1570898143990 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1570898143990 .edgeLabel{background-color:#e8e8e8}#mermaid-1570898143990 .cluster rect{fill:#ffffde;stroke:#aa3;stroke-width:1px}#mermaid-1570898143990 .cluster text{fill:#333}#mermaid-1570898143990 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:'trebuchet ms', verdana, arial;font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-1570898143990 .actor{stroke:#ccf;fill:#ECECFF}#mermaid-1570898143990 text.actor{fill:#000;stroke:none}#mermaid-1570898143990 .actor-line{stroke:grey}#mermaid-1570898143990 .messageLine0{stroke-width:1.5;stroke-dasharray:'2 2';stroke:#333}#mermaid-1570898143990 .messageLine1{stroke-width:1.5;stroke-dasharray:'2 2';stroke:#333}#mermaid-1570898143990 #arrowhead{fill:#333}#mermaid-1570898143990 .sequenceNumber{fill:#fff}#mermaid-1570898143990 #sequencenumber{fill:#333}#mermaid-1570898143990 #crosshead path{fill:#333 !important;stroke:#333 !important}#mermaid-1570898143990 .messageText{fill:#333;stroke:none}#mermaid-1570898143990 .labelBox{stroke:#ccf;fill:#ECECFF}#mermaid-1570898143990 .labelText{fill:#000;stroke:none}#mermaid-1570898143990 .loopText{fill:#000;stroke:none}#mermaid-1570898143990 .loopLine{stroke-width:2;stroke-dasharray:'2 2';stroke:#ccf}#mermaid-1570898143990 .note{stroke:#aa3;fill:#fff5ad}#mermaid-1570898143990 .noteText{fill:black;stroke:none;font-family:'trebuchet ms', verdana, arial;font-size:14px}#mermaid-1570898143990 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-1570898143990 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-1570898143990 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-1570898143990 .section{stroke:none;opacity:0.2}#mermaid-1570898143990 .section0{fill:rgba(102,102,255,0.49)}#mermaid-1570898143990 .section2{fill:#fff400}#mermaid-1570898143990 .section1,#mermaid-1570898143990 .section3{fill:#fff;opacity:0.2}#mermaid-1570898143990 .sectionTitle0{fill:#333}#mermaid-1570898143990 .sectionTitle1{fill:#333}#mermaid-1570898143990 .sectionTitle2{fill:#333}#mermaid-1570898143990 .sectionTitle3{fill:#333}#mermaid-1570898143990 .sectionTitle{text-anchor:start;font-size:11px;text-height:14px}#mermaid-1570898143990 .grid .tick{stroke:#d3d3d3;opacity:0.3;shape-rendering:crispEdges}#mermaid-1570898143990 .grid path{stroke-width:0}#mermaid-1570898143990 .today{fill:none;stroke:red;stroke-width:2px}#mermaid-1570898143990 .task{stroke-width:2}#mermaid-1570898143990 .taskText{text-anchor:middle;font-size:11px}#mermaid-1570898143990 .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}#mermaid-1570898143990 .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-1570898143990 .task.clickable{cursor:pointer}#mermaid-1570898143990 .taskText.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mermaid-1570898143990 .taskTextOutsideLeft.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mermaid-1570898143990 .taskTextOutsideRight.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mermaid-1570898143990 .taskText0,#mermaid-1570898143990 .taskText1,#mermaid-1570898143990 .taskText2,#mermaid-1570898143990 .taskText3{fill:#fff}#mermaid-1570898143990 .task0,#mermaid-1570898143990 .task1,#mermaid-1570898143990 .task2,#mermaid-1570898143990 .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-1570898143990 .taskTextOutside0,#mermaid-1570898143990 .taskTextOutside2{fill:#000}#mermaid-1570898143990 .taskTextOutside1,#mermaid-1570898143990 .taskTextOutside3{fill:#000}#mermaid-1570898143990 .active0,#mermaid-1570898143990 .active1,#mermaid-1570898143990 .active2,#mermaid-1570898143990 .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-1570898143990 .activeText0,#mermaid-1570898143990 .activeText1,#mermaid-1570898143990 .activeText2,#mermaid-1570898143990 .activeText3{fill:#000 !important}#mermaid-1570898143990 .done0,#mermaid-1570898143990 .done1,#mermaid-1570898143990 .done2,#mermaid-1570898143990 .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-1570898143990 .doneText0,#mermaid-1570898143990 .doneText1,#mermaid-1570898143990 .doneText2,#mermaid-1570898143990 .doneText3{fill:#000 !important}#mermaid-1570898143990 .crit0,#mermaid-1570898143990 .crit1,#mermaid-1570898143990 .crit2,#mermaid-1570898143990 .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-1570898143990 .activeCrit0,#mermaid-1570898143990 .activeCrit1,#mermaid-1570898143990 .activeCrit2,#mermaid-1570898143990 .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-1570898143990 .doneCrit0,#mermaid-1570898143990 .doneCrit1,#mermaid-1570898143990 .doneCrit2,#mermaid-1570898143990 .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-1570898143990 .milestone{transform:rotate(45deg) scale(0.8, 0.8)}#mermaid-1570898143990 .milestoneText{font-style:italic}#mermaid-1570898143990 .doneCritText0,#mermaid-1570898143990 .doneCritText1,#mermaid-1570898143990 .doneCritText2,#mermaid-1570898143990 .doneCritText3{fill:#000 !important}#mermaid-1570898143990 .activeCritText0,#mermaid-1570898143990 .activeCritText1,#mermaid-1570898143990 .activeCritText2,#mermaid-1570898143990 .activeCritText3{fill:#000 !important}#mermaid-1570898143990 .titleText{text-anchor:middle;font-size:18px;fill:#000}#mermaid-1570898143990 g.classGroup text{fill:#9370db;stroke:none;font-family:'trebuchet ms', verdana, arial;font-size:10px}#mermaid-1570898143990 g.classGroup rect{fill:#ECECFF;stroke:#9370db}#mermaid-1570898143990 g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-1570898143990 .classLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5}#mermaid-1570898143990 .classLabel .label{fill:#9370db;font-size:10px}#mermaid-1570898143990 .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-1570898143990 #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1570898143990 #compositionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1570898143990 #aggregationStart{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mermaid-1570898143990 #aggregationEnd{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mermaid-1570898143990 #dependencyStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1570898143990 #dependencyEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1570898143990 #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1570898143990 #extensionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1570898143990 .commit-id,#mermaid-1570898143990 .commit-msg,#mermaid-1570898143990 .branch-label{fill:lightgrey;color:lightgrey}#mermaid-1570898143990 .pieTitleText{text-anchor:middle;font-size:25px;fill:#000}


</style><style>#mermaid-1570898143990 {
    color: rgb(0, 0, 0);
    font: normal normal 400 normal 16px / normal "Times New Roman";
  }</style><g></g><g><line id="actor0" x1="75" y1="5" x2="75" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="75" dy="0">RetrievalClient</tspan></text></g><g><line id="actor1" x1="275" y1="5" x2="275" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="200" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="275" dy="0">RetrievalProvider</tspan></text></g><g><line id="actor2" x1="475" y1="5" x2="475" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="400" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="475" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="475" dy="0">StorageMarketParticipant1</tspan></text></g><g><line id="actor3" x1="675" y1="5" x2="675" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="600" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="675" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="675" dy="0">StorageMarketParticipant2</tspan></text></g><g><line id="actor4" x1="875" y1="5" x2="875" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="800" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="875" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="875" dy="0">StorageMarketActor</tspan></text></g><g><line id="actor5" x1="1075" y1="5" x2="1075" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="1000" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1075" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="1075" dy="0">PaymentChannelActor</tspan></text></g><g><line id="actor6" x1="1275" y1="5" x2="1275" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="1200" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1275" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="1275" dy="0">PaymentSubsystem</tspan></text></g><g><line id="actor7" x1="1475" y1="5" x2="1475" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="1400" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1475" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="1475" dy="0">BlockchainSubsystem</tspan></text></g><g><line id="actor8" x1="1675" y1="5" x2="1675" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="1600" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1675" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="1675" dy="0">BlockSyncer</tspan></text></g><g><line id="actor9" x1="1875" y1="5" x2="1875" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="1800" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1875" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="1875" dy="0">BlockProducer</tspan></text></g><g><line id="actor10" x1="2075" y1="5" x2="2075" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="2000" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="2075" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="2075" dy="0">StoragePowerConsensusSubsystem</tspan></text></g><g><line id="actor11" x1="2275" y1="5" x2="2275" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="2200" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="2275" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="2275" dy="0">StoragePowerActor</tspan></text></g><g><line id="actor12" x1="2475" y1="5" x2="2475" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="2400" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="2475" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="2475" dy="0">StorageMiningSubsystem</tspan></text></g><g><line id="actor13" x1="2675" y1="5" x2="2675" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="2600" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="2675" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="2675" dy="0">StorageMinerActor</tspan></text></g><g><line id="actor14" x1="2875" y1="5" x2="2875" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="2800" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="2875" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="2875" dy="0">SectorIndexerSubsystem</tspan></text></g><g><line id="actor15" x1="3075" y1="5" x2="3075" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="3000" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="3075" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="3075" dy="0">StorageProvingSubsystem</tspan></text></g><g><line id="actor16" x1="3275" y1="5" x2="3275" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="3200" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="3275" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="3275" dy="0">FilecoinProofsSubsystem</tspan></text></g><g><line id="actor17" x1="3475" y1="5" x2="3475" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="3400" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="3475" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="3475" dy="0">ClockSubsystem</tspan></text></g><g><line id="actor18" x1="3675" y1="5" x2="3675" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="3600" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="3675" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="3675" dy="0">libp2p</tspan></text></g><g><line id="actor19" x1="3875" y1="5" x2="3875" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="3800" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="3875" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="3875" dy="0">StorageMarketParticipant</tspan></text></g><g><line id="actor20" x1="4075" y1="5" x2="4075" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="4000" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="4075" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="4075" dy="0">SectorSealer</tspan></text></g><g><line id="actor21" x1="4275" y1="5" x2="4275" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="4200" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="4275" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="4275" dy="0">WallClock</tspan></text></g><g><line id="actor22" x1="4475" y1="5" x2="4475" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="4400" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="4475" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="4475" dy="0">Blockchain</tspan></text></g><g><line id="actor23" x1="4675" y1="5" x2="4675" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="4600" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="4675" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="4675" dy="0">MessagePool</tspan></text></g><g><line id="actor24" x1="4875" y1="5" x2="4875" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="4800" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="4875" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="4875" dy="0">MiningScheduler</tspan></text></g><g><line id="actor25" x1="5075" y1="5" x2="5075" y2="6574" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="5000" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="5075" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="5075" dy="0">StorageMinerSubsystem</tspan></text></g><defs><marker id="arrowhead" refX="5" refY="2" markerWidth="6" markerHeight="4" orient="auto"><path d="M 0,0 V 4 L6,2 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray: 0, 0;"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray: 0, 0;"></path></marker></defs><defs><marker id="sequencenumber" refX="15" refY="15" markerWidth="60" markerHeight="40" orient="auto"><circle cx="15" cy="15" r="6"></circle></marker></defs><g><rect x="50" y="75" fill="#EDF2AE" stroke="#666" width="250" height="36" rx="0" ry="0" class="note"></rect><text x="46" y="99" class="noteText"><tspan x="66">RetrievalMarketSubsystem</tspan></text></g><g><rect x="850" y="121" fill="#EDF2AE" stroke="#666" width="3050" height="36" rx="0" ry="0" class="note"></rect><text x="846" y="145" class="noteText"><tspan x="866">StorageMarketSubsystem</tspan></text></g><g><rect x="1450" y="167" fill="#EDF2AE" stroke="#666" width="850" height="36" rx="0" ry="0" class="note"></rect><text x="1446" y="191" class="noteText"><tspan x="1466">BlockchainGroup</tspan></text></g><g><rect x="2450" y="213" fill="#EDF2AE" stroke="#666" width="650" height="36" rx="0" ry="0" class="note"></rect><text x="2446" y="237" class="noteText"><tspan x="2466">MiningGroup</tspan></text></g><g><text x="175" y="302" class="messageText" style="text-anchor: middle;">NewRetrievalQuery(RetreivalQuery)</text><line x1="75" y1="309" x2="275" y2="309" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="270" y="311" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="172.5" y="337" class="messageText" style="text-anchor: middle;">RetrievalQueryResponse</text><line x1="270" y1="344" x2="75" y2="344" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="175" y="372" class="messageText" style="text-anchor: middle;">NewRetrievalDealProposal(RetrievalDealProposal)</text><line x1="75" y1="379" x2="275" y2="379" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="270" y="381" fill="#EDF2AE" stroke="#666" width="10" height="98" rx="0" ry="0" class="activation0"></rect></g><g><text x="280" y="407" class="messageText" style="text-anchor: middle;">AcceptRetrievalDealProposal(RetrievalDealPropsal)</text><path d="M 280,414 C 340,404 340,444 280,434" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></path></g><g><text x="172.5" y="472" class="messageText" style="text-anchor: middle;">NewPaymentChannel</text><line x1="270" y1="479" x2="75" y2="479" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><line x1="65" y1="259" x2="458.828125" y2="259" class="loopLine"></line><line x1="458.828125" y1="259" x2="458.828125" y2="489" class="loopLine"></line><line x1="65" y1="489" x2="458.828125" y2="489" class="loopLine"></line><line x1="65" y1="259" x2="65" y2="489" class="loopLine"></line><polygon points="65,259 115,259 115,272 106.6,279 65,279" class="labelBox"></polygon><text x="72.5" y="274" class="labelText"><tspan x="72.5">opt</tspan></text><text x="261.9140625" y="274" class="loopText" style="text-anchor: middle;"><tspan x="261.9140625">[ RetrievalMarket ]</tspan></text></g><g><text x="2475" y="542" class="messageText" style="text-anchor: middle;">CreateMiner(ownerPubKey PubKey, workerPubKey PubKey, pledgeAmt TokenAmount)</text><path d="M 2475,549 C 2535,539 2535,579 2475,569" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2375" y="607" class="messageText" style="text-anchor: middle;">CreateStorageMiner(OwnerAddr, WorkerPubKey)</text><line x1="2475" y1="614" x2="2275" y2="614" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="2270" y="616" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="2377.5" y="642" class="messageText" style="text-anchor: middle;">StorageMinerActor</text><line x1="2280" y1="649" x2="2475" y2="649" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><line x1="2178.875" y1="499" x2="2771.125" y2="499" class="loopLine"></line><line x1="2771.125" y1="499" x2="2771.125" y2="659" class="loopLine"></line><line x1="2178.875" y1="659" x2="2771.125" y2="659" class="loopLine"></line><line x1="2178.875" y1="499" x2="2178.875" y2="659" class="loopLine"></line><polygon points="2178.875,499 2228.875,499 2228.875,512 2220.475,519 2178.875,519" class="labelBox"></polygon><text x="2186.375" y="514" class="labelText"><tspan x="2186.375">opt</tspan></text><text x="2475" y="514" class="loopText" style="text-anchor: middle;"><tspan x="2475">[ RegisterStorageMiner ]</tspan></text></g><g><text x="675" y="712" class="messageText" style="text-anchor: middle;">RegisterParticipant(TokenAmount)</text><line x1="475" y1="719" x2="875" y2="719" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="675" y="747" class="messageText" style="text-anchor: middle;">AddBalance(TokenAmount)</text><line x1="475" y1="754" x2="875" y2="754" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="675" y="782" class="messageText" style="text-anchor: middle;">WithdrawBalance(TokenAmount)</text><line x1="475" y1="789" x2="875" y2="789" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="675" y="817" class="messageText" style="text-anchor: middle;">CheckLockedBalance(Address)</text><line x1="475" y1="824" x2="875" y2="824" class="messageLine1" stroke-width="2" stroke="black" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><rect x="870" y="826" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="672.5" y="852" class="messageText" style="text-anchor: middle;">TokenAmount</text><line x1="870" y1="859" x2="475" y2="859" class="messageLine1" stroke-width="2" stroke="black" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="575" y="887" class="messageText" style="text-anchor: middle;">NewStorageDealProposal(StorageDealProposal)</text><line x1="475" y1="894" x2="675" y2="894" class="messageLine1" stroke-width="2" stroke="black" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><rect x="670" y="896" fill="#EDF2AE" stroke="#666" width="10" height="133" rx="0" ry="0" class="activation0"></rect></g><g><text x="777.5" y="922" class="messageText" style="text-anchor: middle;">VerifyBalance(StorageMarketParticipant1)</text><line x1="680" y1="929" x2="875" y2="929" class="messageLine1" stroke-width="2" stroke="black" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="680" y="957" class="messageText" style="text-anchor: middle;">SignStorageDealProposal(StorageDealProposal)</text><path d="M 680,964 C 740,954 740,994 680,984" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></path></g><g><text x="572.5" y="1022" class="messageText" style="text-anchor: middle;">NewStorageDeal(StorageDeal)</text><line x1="670" y1="1029" x2="475" y2="1029" class="messageLine1" stroke-width="2" stroke="black" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="775" y="1057" class="messageText" style="text-anchor: middle;">PublishStorageDeal(StorageDeal)</text><line x1="675" y1="1064" x2="875" y2="1064" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="675" y="1092" class="messageText" style="text-anchor: middle;">PublishStorageDeal(StorageDeal)</text><line x1="475" y1="1099" x2="875" y2="1099" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><line x1="465" y1="669" x2="890" y2="669" class="loopLine"></line><line x1="890" y1="669" x2="890" y2="1109" class="loopLine"></line><line x1="465" y1="1109" x2="890" y2="1109" class="loopLine"></line><line x1="465" y1="669" x2="465" y2="1109" class="loopLine"></line><polygon points="465,669 515,669 515,682 506.6,689 465,689" class="labelBox"></polygon><text x="472.5" y="684" class="labelText"><tspan x="472.5">opt</tspan></text><text x="677.5" y="684" class="loopText" style="text-anchor: middle;"><tspan x="677.5">[ StorageDealMake ]</tspan></text></g><g><text x="1675" y="1162" class="messageText" style="text-anchor: middle;">HandleStorageDeal(Deal)</text><line x1="875" y1="1169" x2="2475" y2="1169" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="2470" y="1171" fill="#EDF2AE" stroke="#666" width="10" height="168" rx="0" ry="0" class="activation0"></rect></g><g><text x="2677.5" y="1197" class="messageText" style="text-anchor: middle;">AddDealToSector(Deal, SectorID)</text><line x1="2480" y1="1204" x2="2875" y2="1204" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="2870" y="1206" fill="#EDF2AE" stroke="#666" width="10" height="98" rx="0" ry="0" class="activation0"></rect></g><g><text x="2880" y="1232" class="messageText" style="text-anchor: middle;">IndexSectorByDealExpiration(SectorID, Deal)</text><path d="M 2880,1239 C 2940,1229 2940,1269 2880,1259" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2675" y="1297" class="messageText" style="text-anchor: middle;">(SectorID, Deal)</text><line x1="2870" y1="1304" x2="2480" y2="1304" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="1672.5" y="1332" class="messageText" style="text-anchor: middle;">NotifyStorageDealStaged(Deal,SectorID)</text><line x1="2470" y1="1339" x2="875" y2="1339" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><line x1="865" y1="1119" x2="3040.171875" y2="1119" class="loopLine"></line><line x1="3040.171875" y1="1119" x2="3040.171875" y2="1349" class="loopLine"></line><line x1="865" y1="1349" x2="3040.171875" y2="1349" class="loopLine"></line><line x1="865" y1="1119" x2="865" y2="1349" class="loopLine"></line><polygon points="865,1119 915,1119 915,1132 906.6,1139 865,1139" class="labelBox"></polygon><text x="872.5" y="1134" class="labelText"><tspan x="872.5">opt</tspan></text><text x="1952.5859375" y="1134" class="loopText" style="text-anchor: middle;"><tspan x="1952.5859375">[ AddingDealToSector ]</tspan></text></g><g><text x="575" y="1402" class="messageText" style="text-anchor: middle;">QueryStorageDealProposalStatus(StorageDealProposalQuery)</text><line x1="475" y1="1409" x2="675" y2="1409" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="670" y="1411" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="572.5" y="1437" class="messageText" style="text-anchor: middle;">StorageDealProposalQueryResponse</text><line x1="475" y1="1444" x2="670" y2="1444" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="575" y="1472" class="messageText" style="text-anchor: middle;">QueryStorageDealStatus(StorageDealQuery)</text><line x1="475" y1="1479" x2="675" y2="1479" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="670" y="1481" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="572.5" y="1507" class="messageText" style="text-anchor: middle;">StorageDealQueryResponse</text><line x1="475" y1="1514" x2="670" y2="1514" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><line x1="465" y1="1359" x2="690" y2="1359" class="loopLine"></line><line x1="690" y1="1359" x2="690" y2="1524" class="loopLine"></line><line x1="465" y1="1524" x2="690" y2="1524" class="loopLine"></line><line x1="465" y1="1359" x2="465" y2="1524" class="loopLine"></line><polygon points="465,1359 515,1359 515,1372 506.6,1379 465,1379" class="labelBox"></polygon><text x="472.5" y="1374" class="labelText"><tspan x="472.5">opt</tspan></text><text x="577.5" y="1374" class="loopText" style="text-anchor: middle;"><tspan x="577.5">[ ClientQuery ]</tspan></text></g><g><text x="2275" y="1577" class="messageText" style="text-anchor: middle;">GetSealSeed(Chain, Epoch)</text><line x1="2475" y1="1584" x2="2075" y2="1584" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="2070" y="1586" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="2277.5" y="1612" class="messageText" style="text-anchor: middle;">Seed</text><line x1="2080" y1="1619" x2="2475" y2="1619" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2775" y="1647" class="messageText" style="text-anchor: middle;">SealSector(Seed, SectorID, ReplicaCfg)</text><line x1="2475" y1="1654" x2="3075" y2="1654" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="3070" y="1656" fill="#EDF2AE" stroke="#666" width="10" height="103" rx="0" ry="0" class="activation0"></rect></g><g><text x="3577.5" y="1682" class="messageText" style="text-anchor: middle;">Seal(Seed, SectorID, ReplicaCfg)</text><line x1="3080" y1="1689" x2="4075" y2="1689" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="4070" y="1691" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="3575" y="1717" class="messageText" style="text-anchor: middle;">SealOutputs</text><line x1="4070" y1="1724" x2="3080" y2="1724" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2772.5" y="1752" class="messageText" style="text-anchor: middle;">SealOutputs</text><line x1="3070" y1="1759" x2="2475" y2="1759" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="2575" y="1812" class="messageText" style="text-anchor: middle;">CommitSector(Seed, SectorID, SealCommitment, SealProof, [&amp;Deal], [Deal])</text><line x1="2475" y1="1819" x2="2675" y2="1819" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="2975" y="1847" class="messageText" style="text-anchor: middle;">VerifySeal(SectorID, OnSectorInfo)</text><line x1="2675" y1="1854" x2="3275" y2="1854" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="3270" y="1856" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="2972.5" y="1882" class="messageText" style="text-anchor: middle;">{1,0}</text><line x1="3270" y1="1889" x2="2675" y2="1889" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="1775" y="1942" class="messageText" style="text-anchor: middle;">AddDeal(SectorID, [&amp;Deal], DealStatusOnChain)</text><line x1="2675" y1="1949" x2="875" y2="1949" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="1775" y="1977" class="messageText" style="text-anchor: middle;">AddDeal(SectorID, [Deal], DealStatusPending)</text><line x1="2675" y1="1984" x2="875" y2="1984" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="2475" y="2012" class="messageText" style="text-anchor: middle;">IncrementPower(StorageMiner.WorkerPubKey)</text><line x1="2675" y1="2019" x2="2275" y2="2019" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="2575" y="2067" class="messageText" style="text-anchor: middle;">CommitSectorError</text><line x1="2675" y1="2074" x2="2475" y2="2074" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><line x1="865" y1="1899" x2="2685" y2="1899" class="loopLine"></line><line x1="2685" y1="1899" x2="2685" y2="2084" class="loopLine"></line><line x1="865" y1="2084" x2="2685" y2="2084" class="loopLine"></line><line x1="865" y1="1899" x2="865" y2="2084" class="loopLine"></line><line x1="865" y1="2029" x2="2685" y2="2029" class="loopLine" style="stroke-dasharray: 3, 3;"></line><polygon points="865,1899 915,1899 915,1912 906.6,1919 865,1919" class="labelBox"></polygon><text x="872.5" y="1914" class="labelText"><tspan x="872.5">alt</tspan></text><text x="1775" y="1914" class="loopText" style="text-anchor: middle;"><tspan x="1775">[ 1 - success ]</tspan></text><text x="1775" y="2044" class="loopText" style="text-anchor: middle;"><tspan x="1775">[ 0 - failure ]</tspan></text></g><g><line x1="855" y1="1769" x2="3290" y2="1769" class="loopLine"></line><line x1="3290" y1="1769" x2="3290" y2="2094" class="loopLine"></line><line x1="855" y1="2094" x2="3290" y2="2094" class="loopLine"></line><line x1="855" y1="1769" x2="855" y2="2094" class="loopLine"></line><polygon points="855,1769 905,1769 905,1782 896.6,1789 855,1789" class="labelBox"></polygon><text x="862.5" y="1784" class="labelText"><tspan x="862.5">opt</tspan></text><text x="2072.5" y="1784" class="loopText" style="text-anchor: middle;"><tspan x="2072.5">[ CommitSector ]</tspan></text></g><g><line x1="845" y1="1534" x2="4090" y2="1534" class="loopLine"></line><line x1="4090" y1="1534" x2="4090" y2="2104" class="loopLine"></line><line x1="845" y1="2104" x2="4090" y2="2104" class="loopLine"></line><line x1="845" y1="1534" x2="845" y2="2104" class="loopLine"></line><polygon points="845,1534 895,1534 895,1547 886.6,1554 845,1554" class="labelBox"></polygon><text x="852.5" y="1549" class="labelText"><tspan x="852.5">opt</tspan></text><text x="2467.5" y="1549" class="loopText" style="text-anchor: middle;"><tspan x="2467.5">[ SealingSector ]</tspan></text></g><g><text x="2675" y="2157" class="messageText" style="text-anchor: middle;">Subscribe(OnNewBlock)</text><line x1="1675" y1="2164" x2="3675" y2="2164" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="3670" y="2166" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="2672.5" y="2192" class="messageText" style="text-anchor: middle;">Event(OnNewBlock, block)</text><line x1="3670" y1="2199" x2="1675" y2="2199" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="1675" y="2227" class="messageText" style="text-anchor: middle;">ValidateBlockSyntax(block)</text><path d="M 1675,2234 C 1735,2224 1735,2264 1675,2254" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="1575" y="2292" class="messageText" style="text-anchor: middle;">HandleBlock(block)</text><line x1="1675" y1="2299" x2="1475" y2="2299" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="1470" y="2301" fill="#EDF2AE" stroke="#666" width="10" height="198" rx="0" ry="0" class="activation0"></rect></g><g><text x="1480" y="2327" class="messageText" style="text-anchor: middle;">ValidateBlock(block)</text><path d="M 1480,2334 C 1540,2324 1540,2364 1480,2354" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="1777.5" y="2392" class="messageText" style="text-anchor: middle;">ValidateBlock(block)</text><line x1="1480" y1="2399" x2="2075" y2="2399" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="2377.5" y="2427" class="messageText" style="text-anchor: middle;">ValidateBlock(block)</text><line x1="1480" y1="2434" x2="3275" y2="2434" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="1480" y="2462" class="messageText" style="text-anchor: middle;">StateTree ← TryGenerateStateTree(block)</text><path d="M 1480,2469 C 1540,2459 1540,2499 1480,2489" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2875" y="2552" class="messageText" style="text-anchor: middle;">AssembleTipsets()</text><line x1="4275" y1="2559" x2="1475" y2="2559" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="1475" y="2587" class="messageText" style="text-anchor: middle;">[Tipset] ← AssembleTipsets()</text><path d="M 1475,2594 C 1535,2584 1535,2624 1475,2614" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="1475" y="2652" class="messageText" style="text-anchor: middle;">Tipset ← ChooseTipset([Tipset])</text><path d="M 1475,2659 C 1535,2649 1535,2689 1475,2679" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2975" y="2717" class="messageText" style="text-anchor: middle;">ApplyStateTree(StateTree)</text><line x1="1475" y1="2724" x2="4475" y2="2724" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><line x1="1359.1875" y1="2509" x2="4485" y2="2509" class="loopLine"></line><line x1="4485" y1="2509" x2="4485" y2="2734" class="loopLine"></line><line x1="1359.1875" y1="2734" x2="4485" y2="2734" class="loopLine"></line><line x1="1359.1875" y1="2509" x2="1359.1875" y2="2734" class="loopLine"></line><polygon points="1359.1875,2509 1409.1875,2509 1409.1875,2522 1400.7875,2529 1359.1875,2529" class="labelBox"></polygon><text x="1366.6875" y="2524" class="labelText"><tspan x="1366.6875">opt</tspan></text><text x="2922.09375" y="2524" class="loopText" style="text-anchor: middle;"><tspan x="2922.09375">[ Round Cutoff ]</tspan></text></g><g><line x1="1334.015625" y1="2114" x2="4495" y2="2114" class="loopLine"></line><line x1="4495" y1="2114" x2="4495" y2="2744" class="loopLine"></line><line x1="1334.015625" y1="2744" x2="4495" y2="2744" class="loopLine"></line><line x1="1334.015625" y1="2114" x2="1334.015625" y2="2744" class="loopLine"></line><polygon points="1334.015625,2114 1384.015625,2114 1384.015625,2127 1375.615625,2134 1334.015625,2134" class="labelBox"></polygon><text x="1341.515625" y="2129" class="labelText"><tspan x="1341.515625">loop</tspan></text><text x="2914.5078125" y="2129" class="loopText" style="text-anchor: middle;"><tspan x="2914.5078125">[ BlockReception ]</tspan></text></g><g><text x="1975" y="2822" class="messageText" style="text-anchor: middle;">OnNewTipset(Chain, Epoch)</text><line x1="1475" y1="2829" x2="2475" y2="2829" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="3375" y="2877" class="messageText" style="text-anchor: middle;">OnNewRound()</text><line x1="4275" y1="2884" x2="2475" y2="2884" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="4300" y="2894" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="4296" y="2918" class="noteText"><tspan x="4316">epoch is incremented by 1</tspan></text></g><g><line x1="1465" y1="2779" x2="4460" y2="2779" class="loopLine"></line><line x1="4460" y1="2779" x2="4460" y2="2940" class="loopLine"></line><line x1="1465" y1="2940" x2="4460" y2="2940" class="loopLine"></line><line x1="1465" y1="2779" x2="1465" y2="2940" class="loopLine"></line><line x1="1465" y1="2839" x2="4460" y2="2839" class="loopLine" style="stroke-dasharray: 3, 3;"></line><polygon points="1465,2779 1515,2779 1515,2792 1506.6,2799 1465,2799" class="labelBox"></polygon><text x="1472.5" y="2794" class="labelText"><tspan x="1472.5">alt</tspan></text><text x="2962.5" y="2794" class="loopText" style="text-anchor: middle;"><tspan x="2962.5">[ New Tipset ]</tspan></text><text x="2962.5" y="2854" class="loopText" style="text-anchor: middle;"><tspan x="2962.5">[ Null block last round ]</tspan></text></g><g><text x="2275" y="2968" class="messageText" style="text-anchor: middle;">GetElectionArtifacts(Chain, Epoch)</text><line x1="2475" y1="2975" x2="2075" y2="2975" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="2070" y="2977" fill="#EDF2AE" stroke="#666" width="10" height="163" rx="0" ry="0" class="activation0"></rect></g><g><text x="2080" y="3003" class="messageText" style="text-anchor: middle;">TK ← TicketAtEpoch(Chain, Epoch-k)</text><path d="M 2080,3010 C 2140,3000 2140,3040 2080,3030" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2080" y="3068" class="messageText" style="text-anchor: middle;">T1 ← TicketAtEpoch(Chain, Epoch-1)</text><path d="M 2080,3075 C 2140,3065 2140,3105 2080,3095" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2277.5" y="3133" class="messageText" style="text-anchor: middle;">TK, T1</text><line x1="2080" y1="3140" x2="2475" y2="3140" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2475" y="3193" class="messageText" style="text-anchor: middle;">EP ← DrawElectionProof(TK.randomness(), StorageMiner.WorkerKey)</text><path d="M 2475,3200 C 2535,3190 2535,3230 2475,3220" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2475" y="3283" class="messageText" style="text-anchor: middle;">T0 ← GenerateNextTicket(T1.randomness(), StorageMiner.WorkerKey)</text><path d="M 2475,3290 C 2535,3280 2535,3320 2475,3310" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2475" y="3368" class="messageText" style="text-anchor: middle;">T1 ← GenerateNextTicket(T0.randomness(), StorageMiner.WorkerKey)</text><path d="M 2475,3375 C 2535,3365 2535,3405 2475,3395" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><rect x="2500" y="3415" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="2496" y="3439" class="noteText"><tspan x="2516">Using tickets derived in failed election proof in last epoch</tspan></text></g><g><line x1="2233.109375" y1="3240" x2="2716.890625" y2="3240" class="loopLine"></line><line x1="2716.890625" y1="3240" x2="2716.890625" y2="3461" class="loopLine"></line><line x1="2233.109375" y1="3461" x2="2716.890625" y2="3461" class="loopLine"></line><line x1="2233.109375" y1="3240" x2="2233.109375" y2="3461" class="loopLine"></line><line x1="2233.109375" y1="3330" x2="2716.890625" y2="3330" class="loopLine" style="stroke-dasharray: 3, 3;"></line><polygon points="2233.109375,3240 2283.109375,3240 2283.109375,3253 2274.709375,3260 2233.109375,3260" class="labelBox"></polygon><text x="2240.609375" y="3255" class="labelText"><tspan x="2240.609375">alt</tspan></text><text x="2475" y="3255" class="loopText" style="text-anchor: middle;"><tspan x="2475">[ New Tipset ]</tspan></text><text x="2475" y="3345" class="loopText" style="text-anchor: middle;"><tspan x="2475">[ Null block last round ]</tspan></text></g><g><text x="2275" y="3489" class="messageText" style="text-anchor: middle;">TryLeaderElection(EP)</text><line x1="2475" y1="3496" x2="2075" y2="3496" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="2070" y="3498" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="2277.5" y="3524" class="messageText" style="text-anchor: middle;">{1, 0}</text><line x1="2080" y1="3531" x2="2475" y2="3531" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2275" y="3584" class="messageText" style="text-anchor: middle;">GetPoStChallenge(Chain, Epoch)</text><line x1="2475" y1="3591" x2="2075" y2="3591" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="2070" y="3593" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="2277.5" y="3619" class="messageText" style="text-anchor: middle;">challenge</text><line x1="2080" y1="3626" x2="2475" y2="3626" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2775" y="3654" class="messageText" style="text-anchor: middle;">GeneratePoSt(challenge, [SectorID])</text><line x1="2475" y1="3661" x2="3075" y2="3661" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="3070" y="3663" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="2772.5" y="3689" class="messageText" style="text-anchor: middle;">PoStProof</text><line x1="3070" y1="3696" x2="2475" y2="3696" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2575" y="3749" class="messageText" style="text-anchor: middle;">SubmitPoSt(PoStProof, DoneSet)</text><line x1="2475" y1="3756" x2="2675" y2="3756" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="2975" y="3784" class="messageText" style="text-anchor: middle;">VerifyPoSt(PoStProof)</text><line x1="2675" y1="3791" x2="3275" y2="3791" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="3270" y="3793" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="2972.5" y="3819" class="messageText" style="text-anchor: middle;">{1,0}</text><line x1="3270" y1="3826" x2="2675" y2="3826" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2675" y="3879" class="messageText" style="text-anchor: middle;">UpdateDoneSet()</text><path d="M 2675,3886 C 2735,3876 2735,3916 2675,3906" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="1775" y="3944" class="messageText" style="text-anchor: middle;">HandleStorageDealPayment()</text><line x1="2675" y1="3951" x2="875" y2="3951" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="875" y="3979" class="messageText" style="text-anchor: middle;">CloseExpiredStorageDeal()</text><path d="M 875,3986 C 935,3976 935,4016 875,4006" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2575" y="4064" class="messageText" style="text-anchor: middle;">PoStError</text><line x1="2675" y1="4071" x2="2475" y2="4071" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="875" y="4099" class="messageText" style="text-anchor: middle;">SlashStorageCollateral()</text><path d="M 875,4106 C 935,4096 935,4136 875,4126" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></path></g><g><line x1="765" y1="3836" x2="2785" y2="3836" class="loopLine"></line><line x1="2785" y1="3836" x2="2785" y2="4146" class="loopLine"></line><line x1="765" y1="4146" x2="2785" y2="4146" class="loopLine"></line><line x1="765" y1="3836" x2="765" y2="4146" class="loopLine"></line><line x1="765" y1="4026" x2="2785" y2="4026" class="loopLine" style="stroke-dasharray: 3, 3;"></line><polygon points="765,3836 815,3836 815,3849 806.6,3856 765,3856" class="labelBox"></polygon><text x="772.5" y="3851" class="labelText"><tspan x="772.5">alt</tspan></text><text x="1775" y="3851" class="loopText" style="text-anchor: middle;"><tspan x="1775">[ 1 - success ]</tspan></text><text x="1775" y="4041" class="loopText" style="text-anchor: middle;"><tspan x="1775">[ 0 - failure ]</tspan></text></g><g><line x1="755" y1="3706" x2="3290" y2="3706" class="loopLine"></line><line x1="3290" y1="3706" x2="3290" y2="4156" class="loopLine"></line><line x1="755" y1="4156" x2="3290" y2="4156" class="loopLine"></line><line x1="755" y1="3706" x2="755" y2="4156" class="loopLine"></line><polygon points="755,3706 805,3706 805,3719 796.6,3726 755,3726" class="labelBox"></polygon><text x="762.5" y="3721" class="labelText"><tspan x="762.5">opt</tspan></text><text x="2022.5" y="3721" class="loopText" style="text-anchor: middle;"><tspan x="2022.5">[ SubmitPoSt ]</tspan></text></g><g><text x="2175" y="4184" class="messageText" style="text-anchor: middle;">GenerateBlock(EP, T0, Tipset, StorageMiner.Address)</text><line x1="2475" y1="4191" x2="1875" y2="4191" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="3275" y="4219" class="messageText" style="text-anchor: middle;">GetMostProfitableMessages(StorageMiner.Address)</text><line x1="1875" y1="4226" x2="4675" y2="4226" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="4670" y="4228" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="3272.5" y="4254" class="messageText" style="text-anchor: middle;">[Message]</text><line x1="4670" y1="4261" x2="1875" y2="4261" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="1875" y="4289" class="messageText" style="text-anchor: middle;">block ← AssembleBlock([Message], Tipset, EP, T0, StorageMiner.Address)</text><path d="M 1875,4296 C 1935,4286 1935,4326 1875,4316" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="1775" y="4354" class="messageText" style="text-anchor: middle;">PropagateBlock(block)</text><line x1="1875" y1="4361" x2="1675" y2="4361" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><line x1="745" y1="3541" x2="4690" y2="3541" class="loopLine"></line><line x1="4690" y1="3541" x2="4690" y2="4371" class="loopLine"></line><line x1="745" y1="4371" x2="4690" y2="4371" class="loopLine"></line><line x1="745" y1="3541" x2="745" y2="4371" class="loopLine"></line><polygon points="745,3541 795,3541 795,3554 786.6,3561 745,3561" class="labelBox"></polygon><text x="752.5" y="3556" class="labelText"><tspan x="752.5">opt</tspan></text><text x="2717.5" y="3556" class="loopText" style="text-anchor: middle;"><tspan x="2717.5">[ 1- success ]</tspan></text></g><g><line x1="735" y1="3150" x2="4700" y2="3150" class="loopLine"></line><line x1="4700" y1="3150" x2="4700" y2="4381" class="loopLine"></line><line x1="735" y1="4381" x2="4700" y2="4381" class="loopLine"></line><line x1="735" y1="3150" x2="735" y2="4381" class="loopLine"></line><polygon points="735,3150 785,3150 785,3163 776.6,3170 735,3170" class="labelBox"></polygon><text x="742.5" y="3165" class="labelText"><tspan x="742.5">loop</tspan></text><text x="2717.5" y="3165" class="loopText" style="text-anchor: middle;"><tspan x="2717.5">[ forEach StorageMiningSubsystem.StorageMiner ]</tspan></text></g><g><line x1="725" y1="2754" x2="4710" y2="2754" class="loopLine"></line><line x1="4710" y1="2754" x2="4710" y2="4391" class="loopLine"></line><line x1="725" y1="4391" x2="4710" y2="4391" class="loopLine"></line><line x1="725" y1="2754" x2="725" y2="4391" class="loopLine"></line><polygon points="725,2754 775,2754 775,2767 766.6,2774 725,2774" class="labelBox"></polygon><text x="732.5" y="2769" class="labelText"><tspan x="732.5">loop</tspan></text><text x="2717.5" y="2769" class="loopText" style="text-anchor: middle;"><tspan x="2717.5">[ BlockProduction ]</tspan></text></g><g><text x="2175" y="4469" class="messageText" style="text-anchor: middle;">OnNewTipset(Chain, Epoch)</text><line x1="1475" y1="4476" x2="2875" y2="4476" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="2875" y="4504" class="messageText" style="text-anchor: middle;">[SectorID] ← LookupSectorByDealExpiry(Epoch)</text><path d="M 2875,4511 C 2935,4501 2935,4541 2875,4531" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2875" y="4569" class="messageText" style="text-anchor: middle;">PurgeSectorsWithNoLiveDeals([SectorID])</text><path d="M 2875,4576 C 2935,4566 2935,4606 2875,4596" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2675" y="4634" class="messageText" style="text-anchor: middle;">HandleExpiredDeals([SectorID])</text><line x1="2875" y1="4641" x2="2475" y2="4641" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="2470" y="4643" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="1672.5" y="4669" class="messageText" style="text-anchor: middle;">CloseExpiredStorageDeal(StorageDeal)</text><line x1="2470" y1="4676" x2="875" y2="4676" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><line x1="865" y1="4426" x2="3048.515625" y2="4426" class="loopLine"></line><line x1="3048.515625" y1="4426" x2="3048.515625" y2="4686" class="loopLine"></line><line x1="865" y1="4686" x2="3048.515625" y2="4686" class="loopLine"></line><line x1="865" y1="4426" x2="865" y2="4686" class="loopLine"></line><polygon points="865,4426 915,4426 915,4439 906.6,4446 865,4446" class="labelBox"></polygon><text x="872.5" y="4441" class="labelText"><tspan x="872.5">opt</tspan></text><text x="1956.7578125" y="4441" class="loopText" style="text-anchor: middle;"><tspan x="1956.7578125">[ Expired deals ]</tspan></text></g><g><rect x="4900" y="4696" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="4896" y="4720" class="noteText"><tspan x="4916">Schedule and resume PoSts</tspan></text></g><g><rect x="4900" y="4742" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="4896" y="4766" class="noteText"><tspan x="4916">Schedule and resume SEALs</tspan></text></g><g><rect x="4900" y="4788" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="4896" y="4812" class="noteText"><tspan x="4916">Maintain FaultSet</tspan></text></g><g><rect x="4900" y="4834" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="4896" y="4858" class="noteText"><tspan x="4916">Maintain DoneSet</tspan></text></g><g><line x1="855" y1="4401" x2="5060" y2="4401" class="loopLine"></line><line x1="5060" y1="4401" x2="5060" y2="4880" class="loopLine"></line><line x1="855" y1="4880" x2="5060" y2="4880" class="loopLine"></line><line x1="855" y1="4401" x2="855" y2="4880" class="loopLine"></line><polygon points="855,4401 905,4401 905,4414 896.6,4421 855,4421" class="labelBox"></polygon><text x="862.5" y="4416" class="labelText"><tspan x="862.5">opt</tspan></text><text x="2957.5" y="4416" class="loopText" style="text-anchor: middle;"><tspan x="2957.5">[ MiningScheduler ]</tspan></text></g><g><rect x="3500" y="4915" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="3496" y="4939" class="noteText"><tspan x="3516">PoSt challenge if a node has not mined a block in a ProvingPeriod</tspan></text></g><g><text x="2775" y="4979" class="messageText" style="text-anchor: middle;">GetPoStChallenge(Chain, Epoch)</text><line x1="3475" y1="4986" x2="2075" y2="4986" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="2070" y="4988" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="2277.5" y="5014" class="messageText" style="text-anchor: middle;">challenge</text><line x1="2080" y1="5021" x2="2475" y2="5021" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2775" y="5049" class="messageText" style="text-anchor: middle;">GeneratePoSt(challenge, [SectorID])</text><line x1="2475" y1="5056" x2="3075" y2="5056" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="3070" y="5058" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="2772.5" y="5084" class="messageText" style="text-anchor: middle;">PoStProof</text><line x1="3070" y1="5091" x2="2475" y2="5091" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2575" y="5144" class="messageText" style="text-anchor: middle;">SubmitPoSt(PoStProof, DoneSet)</text><line x1="2475" y1="5151" x2="2675" y2="5151" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="2975" y="5179" class="messageText" style="text-anchor: middle;">VerifyPoSt(PoStProof)</text><line x1="2675" y1="5186" x2="3275" y2="5186" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="3270" y="5188" fill="#EDF2AE" stroke="#666" width="10" height="33" rx="0" ry="0" class="activation0"></rect></g><g><text x="2972.5" y="5214" class="messageText" style="text-anchor: middle;">{1,0}</text><line x1="3270" y1="5221" x2="2675" y2="5221" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2675" y="5274" class="messageText" style="text-anchor: middle;">UpdateDoneSet()</text><path d="M 2675,5281 C 2735,5271 2735,5311 2675,5301" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="1775" y="5339" class="messageText" style="text-anchor: middle;">HandleStorageDealPayment()</text><line x1="2675" y1="5346" x2="875" y2="5346" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="875" y="5374" class="messageText" style="text-anchor: middle;">CloseExpiredStorageDeal()</text><path d="M 875,5381 C 935,5371 935,5411 875,5401" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2575" y="5459" class="messageText" style="text-anchor: middle;">PoStError</text><line x1="2675" y1="5466" x2="2475" y2="5466" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="875" y="5494" class="messageText" style="text-anchor: middle;">SlashStorageCollateral()</text><path d="M 875,5501 C 935,5491 935,5531 875,5521" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></path></g><g><line x1="765" y1="5231" x2="2785" y2="5231" class="loopLine"></line><line x1="2785" y1="5231" x2="2785" y2="5541" class="loopLine"></line><line x1="765" y1="5541" x2="2785" y2="5541" class="loopLine"></line><line x1="765" y1="5231" x2="765" y2="5541" class="loopLine"></line><line x1="765" y1="5421" x2="2785" y2="5421" class="loopLine" style="stroke-dasharray: 3, 3;"></line><polygon points="765,5231 815,5231 815,5244 806.6,5251 765,5251" class="labelBox"></polygon><text x="772.5" y="5246" class="labelText"><tspan x="772.5">alt</tspan></text><text x="1775" y="5246" class="loopText" style="text-anchor: middle;"><tspan x="1775">[ 1 - success ]</tspan></text><text x="1775" y="5436" class="loopText" style="text-anchor: middle;"><tspan x="1775">[ 0 - failure ]</tspan></text></g><g><line x1="755" y1="5101" x2="3290" y2="5101" class="loopLine"></line><line x1="3290" y1="5101" x2="3290" y2="5551" class="loopLine"></line><line x1="755" y1="5551" x2="3290" y2="5551" class="loopLine"></line><line x1="755" y1="5101" x2="755" y2="5551" class="loopLine"></line><polygon points="755,5101 805,5101 805,5114 796.6,5121 755,5121" class="labelBox"></polygon><text x="762.5" y="5116" class="labelText"><tspan x="762.5">opt</tspan></text><text x="2022.5" y="5116" class="loopText" style="text-anchor: middle;"><tspan x="2022.5">[ SubmitPoSt ]</tspan></text></g><g><line x1="745" y1="4890" x2="3660" y2="4890" class="loopLine"></line><line x1="3660" y1="4890" x2="3660" y2="5561" class="loopLine"></line><line x1="745" y1="5561" x2="3660" y2="5561" class="loopLine"></line><line x1="745" y1="4890" x2="745" y2="5561" class="loopLine"></line><polygon points="745,4890 795,4890 795,4903 786.6,4910 745,4910" class="labelBox"></polygon><text x="752.5" y="4905" class="labelText"><tspan x="752.5">opt</tspan></text><text x="2202.5" y="4905" class="loopText" style="text-anchor: middle;"><tspan x="2202.5">[ ClockSubsystem ]</tspan></text></g><g><text x="3875" y="5639" class="messageText" style="text-anchor: middle;">UpdateSectorStatus([FaultSet], SectorStateSets)</text><line x1="5075" y1="5646" x2="2675" y2="5646" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="2475" y="5674" class="messageText" style="text-anchor: middle;">RecomputeMinerPower()</text><line x1="2675" y1="5681" x2="2275" y2="5681" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="875" y="5709" class="messageText" style="text-anchor: middle;">SlashStorageCollateral()</text><path d="M 875,5716 C 935,5706 935,5746 875,5736" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></path></g><g><rect x="2700" y="5756" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="2696" y="5780" class="noteText"><tspan x="2716">SectorStateSets := (FaultSet, RecoverSet, ExpireSet)</tspan></text></g><g><line x1="765" y1="5596" x2="5085" y2="5596" class="loopLine"></line><line x1="5085" y1="5596" x2="5085" y2="5802" class="loopLine"></line><line x1="765" y1="5802" x2="5085" y2="5802" class="loopLine"></line><line x1="765" y1="5596" x2="765" y2="5802" class="loopLine"></line><polygon points="765,5596 815,5596 815,5609 806.6,5616 765,5616" class="labelBox"></polygon><text x="772.5" y="5611" class="labelText"><tspan x="772.5">opt</tspan></text><text x="2925" y="5611" class="loopText" style="text-anchor: middle;"><tspan x="2925">[ Declaration before receiving a challenge ]</tspan></text></g><g><text x="2475" y="5905" class="messageText" style="text-anchor: middle;">ProvingPeriodUpdate()</text><line x1="2275" y1="5912" x2="2675" y2="5912" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="2675" y="5940" class="messageText" style="text-anchor: middle;">computeProvingPeriodEndSectorState()</text><path d="M 2675,5947 C 2735,5937 2735,5977 2675,5967" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><rect x="2700" y="5987" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="2696" y="6011" class="noteText"><tspan x="2716">FaultSet is all sectors if no post submitted</tspan></text></g><g><rect x="2700" y="6033" fill="#EDF2AE" stroke="#666" width="150" height="36" rx="0" ry="0" class="note"></rect><text x="2696" y="6057" class="noteText"><tspan x="2716">sectors Faulted longer than threshold proving periods are destroyed</tspan></text></g><g><text x="2675" y="6097" class="messageText" style="text-anchor: middle;">UpdateSectorStatus(newSectorState)</text><path d="M 2675,6104 C 2735,6094 2735,6134 2675,6124" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><text x="2475" y="6162" class="messageText" style="text-anchor: middle;">RecomputeMinerPower()</text><line x1="2675" y1="6169" x2="2275" y2="6169" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="1775" y="6197" class="messageText" style="text-anchor: middle;">HandleFailedDeals([newSectorState.DestroyedSet])</text><line x1="2675" y1="6204" x2="875" y2="6204" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><line x1="865" y1="5862" x2="2860" y2="5862" class="loopLine"></line><line x1="2860" y1="5862" x2="2860" y2="6214" class="loopLine"></line><line x1="865" y1="6214" x2="2860" y2="6214" class="loopLine"></line><line x1="865" y1="5862" x2="865" y2="6214" class="loopLine"></line><polygon points="865,5862 915,5862 915,5875 906.6,5882 865,5882" class="labelBox"></polygon><text x="872.5" y="5877" class="labelText"><tspan x="872.5">opt</tspan></text><text x="1862.5" y="5877" class="loopText" style="text-anchor: middle;"><tspan x="1862.5">[ if miner ProvingPeriod ends ]</tspan></text></g><g><line x1="855" y1="5837" x2="2870" y2="5837" class="loopLine"></line><line x1="2870" y1="5837" x2="2870" y2="6224" class="loopLine"></line><line x1="855" y1="6224" x2="2870" y2="6224" class="loopLine"></line><line x1="855" y1="5837" x2="855" y2="6224" class="loopLine"></line><polygon points="855,5837 905,5837 905,5850 896.6,5857 855,5857" class="labelBox"></polygon><text x="862.5" y="5852" class="labelText"><tspan x="862.5">loop</tspan></text><text x="1862.5" y="5852" class="loopText" style="text-anchor: middle;"><tspan x="1862.5">[ forEach StorageMinerActor in StoragePowerActor.Miners ]</tspan></text></g><g><line x1="845" y1="5812" x2="2880" y2="5812" class="loopLine"></line><line x1="2880" y1="5812" x2="2880" y2="6234" class="loopLine"></line><line x1="845" y1="6234" x2="2880" y2="6234" class="loopLine"></line><line x1="845" y1="5812" x2="845" y2="6234" class="loopLine"></line><polygon points="845,5812 895,5812 895,5825 886.6,5832 845,5832" class="labelBox"></polygon><text x="852.5" y="5827" class="labelText"><tspan x="852.5">loop</tspan></text><text x="1862.5" y="5827" class="loopText" style="text-anchor: middle;"><tspan x="1862.5">[ EveryBlock ]</tspan></text></g><g><line x1="755" y1="5571" x2="5095" y2="5571" class="loopLine"></line><line x1="5095" y1="5571" x2="5095" y2="6244" class="loopLine"></line><line x1="755" y1="6244" x2="5095" y2="6244" class="loopLine"></line><line x1="755" y1="5571" x2="755" y2="6244" class="loopLine"></line><polygon points="755,5571 805,5571 805,5584 796.6,5591 755,5591" class="labelBox"></polygon><text x="762.5" y="5586" class="labelText"><tspan x="762.5">opt</tspan></text><text x="2925" y="5586" class="loopText" style="text-anchor: middle;"><tspan x="2925">[ Storage Fault ]</tspan></text></g><g><text x="2475" y="6297" class="messageText" style="text-anchor: middle;">DeclareConsensusFault(ConsensusFaultProof)</text><line x1="2675" y1="6304" x2="2275" y2="6304" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2175" y="6332" class="messageText" style="text-anchor: middle;">ValidateFault(ConsensusFaultProof)</text><line x1="2275" y1="6339" x2="2075" y2="6339" class="messageLine1" stroke-width="2" stroke="black" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><rect x="2070" y="6341" fill="#EDF2AE" stroke="#666" width="10" height="128" rx="0" ry="0" class="activation0"></rect></g><g><text x="2177.5" y="6392" class="messageText" style="text-anchor: middle;">TerminateMiner(Address)</text><line x1="2080" y1="6399" x2="2275" y2="6399" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2177.5" y="6427" class="messageText" style="text-anchor: middle;">SlashPledgeCollateral(Address)</text><line x1="2080" y1="6434" x2="2275" y2="6434" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="2377.5" y="6462" class="messageText" style="text-anchor: middle;">UpdateBalance(Reward)</text><line x1="2080" y1="6469" x2="2675" y2="6469" class="messageLine1" stroke-width="2" stroke="black" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><line x1="2060" y1="6349" x2="2685" y2="6349" class="loopLine"></line><line x1="2685" y1="6349" x2="2685" y2="6479" class="loopLine"></line><line x1="2060" y1="6479" x2="2685" y2="6479" class="loopLine"></line><line x1="2060" y1="6349" x2="2060" y2="6479" class="loopLine"></line><polygon points="2060,6349 2110,6349 2110,6362 2101.6,6369 2060,6369" class="labelBox"></polygon><text x="2067.5" y="6364" class="labelText"><tspan x="2067.5">opt</tspan></text><text x="2372.5" y="6364" class="loopText" style="text-anchor: middle;"><tspan x="2372.5">[ Valid Fault ]</tspan></text></g><g><line x1="2050" y1="6254" x2="2695" y2="6254" class="loopLine"></line><line x1="2695" y1="6254" x2="2695" y2="6489" class="loopLine"></line><line x1="2050" y1="6489" x2="2695" y2="6489" class="loopLine"></line><line x1="2050" y1="6254" x2="2050" y2="6489" class="loopLine"></line><polygon points="2050,6254 2100,6254 2100,6267 2091.6,6274 2050,6274" class="labelBox"></polygon><text x="2057.5" y="6269" class="labelText"><tspan x="2057.5">opt</tspan></text><text x="2372.5" y="6269" class="loopText" style="text-anchor: middle;"><tspan x="2372.5">[ Consensus Fault ]</tspan></text></g><g><rect x="0" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="75" dy="0">RetrievalClient</tspan></text></g><g><rect x="200" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="275" dy="0">RetrievalProvider</tspan></text></g><g><rect x="400" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="475" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="475" dy="0">StorageMarketParticipant1</tspan></text></g><g><rect x="600" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="675" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="675" dy="0">StorageMarketParticipant2</tspan></text></g><g><rect x="800" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="875" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="875" dy="0">StorageMarketActor</tspan></text></g><g><rect x="1000" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1075" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="1075" dy="0">PaymentChannelActor</tspan></text></g><g><rect x="1200" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1275" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="1275" dy="0">PaymentSubsystem</tspan></text></g><g><rect x="1400" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1475" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="1475" dy="0">BlockchainSubsystem</tspan></text></g><g><rect x="1600" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1675" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="1675" dy="0">BlockSyncer</tspan></text></g><g><rect x="1800" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1875" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="1875" dy="0">BlockProducer</tspan></text></g><g><rect x="2000" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="2075" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="2075" dy="0">StoragePowerConsensusSubsystem</tspan></text></g><g><rect x="2200" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="2275" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="2275" dy="0">StoragePowerActor</tspan></text></g><g><rect x="2400" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="2475" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="2475" dy="0">StorageMiningSubsystem</tspan></text></g><g><rect x="2600" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="2675" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="2675" dy="0">StorageMinerActor</tspan></text></g><g><rect x="2800" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="2875" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="2875" dy="0">SectorIndexerSubsystem</tspan></text></g><g><rect x="3000" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="3075" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="3075" dy="0">StorageProvingSubsystem</tspan></text></g><g><rect x="3200" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="3275" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="3275" dy="0">FilecoinProofsSubsystem</tspan></text></g><g><rect x="3400" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="3475" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="3475" dy="0">ClockSubsystem</tspan></text></g><g><rect x="3600" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="3675" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="3675" dy="0">libp2p</tspan></text></g><g><rect x="3800" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="3875" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="3875" dy="0">StorageMarketParticipant</tspan></text></g><g><rect x="4000" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="4075" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="4075" dy="0">SectorSealer</tspan></text></g><g><rect x="4200" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="4275" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="4275" dy="0">WallClock</tspan></text></g><g><rect x="4400" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="4475" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="4475" dy="0">Blockchain</tspan></text></g><g><rect x="4600" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="4675" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="4675" dy="0">MessagePool</tspan></text></g><g><rect x="4800" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="4875" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="4875" dy="0">MiningScheduler</tspan></text></g><g><rect x="5000" y="6509" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="5075" y="6541.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-family: Open-Sans, sans-serif;"><tspan x="5075" dy="0">StorageMinerSubsystem</tspan></text></g></svg>